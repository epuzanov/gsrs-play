<div class="row info">
    <div class="row">
        <form-header type="codes" parent="parent" iscollapsed = "iscollapsed"></form-header>
    </div>
    <div class="col-md-12" uib-collapse="iscollapsed">
        <form class="form-horizontal" name="codeForm" role="form" id="addCodeForm" novalidate>
            <div class="row form-row">
                <div class="col-md-2">
                    <dropdown-select ng-model="code.codeSystem" field="codeSystem" label="Code System"
                                     cv="CODE_SYSTEM"></dropdown-select>
                </div>
                <div class="col-md-2">
                    <dropdown-select ng-model="code.$$systemCategory" field="$$systemCategory" label="Code System Type"
                                     cv="CODE_SYSTEM_TYPE" filter = "code.codeSystem" class="disabled"></dropdown-select>
                </div>
                <div class="col-md-2">
                    <dropdown-select ng-model="code.type" field="type" cv="CODE_TYPE"></dropdown-select>
                </div>
                <div class="col-md-2">
                    <text-input ng-model="code.code" name = "code" field="code" form = "codeForm" filter = "code.codeSystem" validator="parse(model)"></text-input>
<!--                    		<div ng-repeat="err in errors">
                                ?form
			<span class={{err.class}}>{{err.text}}</span>
		</div>-->
                    <ng-messages for="codeForm.code.$error" ng-if="codeForm.code.$touched">
                        <ng-message when="invalid" class="help-block"></ng-message>
                        <ng-message when="required" class="help-block">code is required</ng-message>
                    </ng-messages>
                </div>
                <div class="col-md-2">
                    <text-input ng-model="code.url" field="url"></text-input>
                </div>
                <div class="col-md-1 pull-right">
                    <form-selector referenceobj="code" parent="parent" divid="codeForm"
                                   type="access"></form-selector>
                </div>
                <div class="col-md-1 pull-right">
                    <reference-modal-button referenceobj= "code" parent = "parent"></reference-modal-button>
                </div>
                </div>
            <div class="row form-row">
                <div class="col-md-2">
                    <form-selector referenceobj="code" divid="codeForm" field="comments" label="Code Text"
                                   type="textbox"></form-selector>
                </div>
            </div>
            <div class="codeForm"></div>
            <submit-buttons submit="code" form="codeForm" path="codes"></submit-buttons>
        </form>

        <div ng-repeat="(index,obj) in parent.codes track by $index">
            <div class="row">

                <hr>
                <div class="col-md-1">
                    <delete-button delete="obj" path="codes"></delete-button>
                </div>
                <div class="col-md-2 err-check">
                    <dropdown-view-edit obj="obj" field="codeSystem" cv="CODE_SYSTEM" label="Code System"></dropdown-view-edit>
                </div>
                <div class="col-md-2 err-check">
                    <dropdown-view-edit obj="obj" field="$$systemCategory" cv="CODE_SYSTEM_TYPE" filter="obj.codeSystem" label="Code System Type" class="disabled"></dropdown-view-edit>
                </div>
                <div class="col-md-2 err-check">
                    <dropdown-view-edit obj="obj" field="type" cv="CODE_TYPE"></dropdown-view-edit>
                </div>
                <div class="col-md-2 err-check">
                    <text-view-edit obj="obj" field="code" form = "codeForm" filter = "obj.codeSystem" validator="parse(model)"></text-view-edit>
<!--                    <div ng-repeat="err in errors">
                        <span class={{err.class}}>{{err.message}}</span>
                    </div>-->
                </div>
                <div class="col-md-2 url">
                    <text-view-edit obj="obj" field="url"></text-view-edit>
                </div>
                <div class="col-md-1 pull-right">
                    <form-selector referenceobj="obj" parent="parent" type="access" divid=code-{{index}}></form-selector>
                </div>
                <div class="col-md-1 pull-right">
                    <reference-modal-button referenceobj= "obj" parent = "parent" edit = "true"></reference-modal-button>

                </div>
                </div>
            <div class = "row">
                <div class="col-md-6 col-md-offset-1">
                    <form-selector referenceobj="obj" formname="codeForm" field="comments" label="Code Text"
                                   type="textbox" divid=code-{{index}} mode="edit"></form-selector>
                </div>
            </div>
            <div class=code-{{index}}></div>
        </div>
    </div>
</div>
