@import play.api.Play.current

@(kind: String, json: String)


@wizardfields(kind: String) = {

    <title-header name = "substance._name" kind = "substance.substanceClass"></title-header>
    @kind match {
        case "chemical" => {

            <div>@forms.structureform()</div>

@*
            <moiety-form parent = substance></moiety-form>
*@


            <div>@forms.moietyform()</div>


        }
        case "mixture" => {
           <mixture-component-select-form parent = substance></mixture-component-select-form>
        }
        case "protein" => {
            <protein-details-form></protein-details-form>
            <subunit-form referenceobj ="referenceobj" parent = substance></subunit-form>
            <div ng-if = "substance.protein.subunits.length>0">
            <other-links-form referenceobj ="referenceobj" parent = substance></other-links-form>
            <disulfide-link-form referenceobj ="referenceobj" parent = substance></disulfide-link-form>
            <glycosylation-form referenceobj ="referenceobj" parent = substance></glycosylation-form>
            <agent-modification-form referenceobj ="referenceobj" parent = substance></agent-modification-form>
            <structural-modification-form referenceobj ="referenceobj" parent = substance></structural-modification-form>
            <physical-modification-form referenceobj ="referenceobj" parent = substance></physical-modification-form>
            </div>
        }
        case "structurallyDiverse" => {
           <diverse-type-form parent = substance></diverse-type-form>
            <div ng-if="substance.diverseType=='part' || substance.diverseType=='whole'">
           <diverse-source-form parent = substance></diverse-source-form>
           <diverse-organism-form ng-if="substance.structurallyDiverse.sourceMaterialClass.value =='ORGANISM'" parent = substance></diverse-organism-form>
            <diverse-details-form  ng-if="substance.structurallyDiverse.sourceMaterialClass.value =='ORGANISM'" parent = substance></diverse-details-form>
            <parent-form parent = substance></parent-form>
            <part-form ng-if="substance.diverseType=='part'" parent = substance></part-form>
            </div>

        }
        case "concept" => {
            <div>Concepts have no defining information, but are collections of terms, codes and related information. They can be promoted to a defined substance at a later time, when appropriate.</div>
        }
        case "polymer" => {
           <div>Polymer not implemented yet, still in development</div>
            <polymer-classification-form parent=substance></polymer-classification-form>
            <polymer-monomer-form parent=substance></polymer-monomer-form>
            <div>@forms.polymerstructureform()</div>

            <polymer-sru-form parent=substance></polymer-sru-form>
@*
           <div>@forms.polymerclassificationform()</div>
           <div>@forms.polymermonomerselectform()</div>
*@
@*
           <div>@forms.polymersruform()</div>
*@
        }
        case "nucleicAcid" => {
           <div>Nucleic Acid not implemented yet, still in development</div>
           <nucleic-acid-details-form parent = substance></nucleic-acid-details-form>
            <subunit-form referenceobj ="referenceobj" parent = substance></subunit-form>
            <div ng-if = "substance.$subunitDisplay.length>0">
                <nucleic-acid-sugar-form referenceobj ="referenceobj" parent = substance></nucleic-acid-sugar-form>
                <nucleic-acid-linkage-form referenceobj ="referenceobj" parent = substance></nucleic-acid-linkage-form>
            </div>

@*
            <div>@forms.nucleicacidsugarform()</div>
*@

@*
           <div>@forms.nucleicacidlinkageform()</div>
*@
        }
        case "specifiedSubstanceG1" => {
            <ss-constituent-form parent = substance></ss-constituent-form>
        }
        case x =>{
            <h2>Unknown substance class: @kind</h2>    
        }
    }
   <official-name-form parent = substance></official-name-form>
    <name-form parent = substance></name-form>
    <code-form parent = substance></code-form>
    <relationship-form parent = substance></relationship-form>
    <note-form parent = substance></note-form>
    <property-form parent = substance></property-form>
   <reference-form-only referenceobj ="referenceobj" parent = "substance"></reference-form-only>
}

@ginas("Register", kind) {
    @menu()
} {
    <h3></h3>
} {
    <h3></h3>
    @*
        Loading all CV
    *@
    <script src="@play.api.Play.configuration.getString("application.context").getOrElse("/ginas/app")/api/v1/vocabularies/?top=100&callback=window.CV_REQUEST="></script>
    <div ng-cloak>
        <form class="form-horizontal" name ="substanceForm" role ="form" novalidate>
        @wizardfields(kind)

        <div class = "row info">
            <div class="col-md-4">
                <button class="btn btn-primary" ng-hide="show" ng-click="viewToggle(); show=true" >Show JSON</button>
                <button class="btn btn-primary" ng-show="show" ng-click="show=false" >Hide JSON</button>
                <button class="btn btn-primary" ng-click="validateSubstance(substance)">Validate</button></div>
            <div class="col-md-2 pull-right">
                <button disabled="canApprove()" class="btn btn-primary" ng-click="approveSubstance(substance)">Approve</button>
                <button class="btn btn-primary" ng-click="submitSubstance(substance)">Submit</button>
            </div>
        </div>
            <pre>Substance Form valid = {{ substanceForm.$valid | json }}</pre>
            <div class = "row" ng-repeat="err in errorsArray">
            <div class="col-md-12">
                <div class="alert {{err.class}} alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span>
                    </button>
                    <span><h4>{{err.messageType}}</h4>
                        <span>{{err.message}}</span>
                        <div ng-repeat="link in err.links">
                            <a target = "_blank" href="{{link.href}}">{{link.text}}</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        </form>
    </div>
    <div class ="row info" ng-show="show">
	<div>
		<span ng-show="viewStyle!=='text'">Showing JSON Object structure</span>
		<span ng-show="viewStyle=='text'">Showing Raw JSON </span>
	</div>	
	<button class="btn btn-primary" ng-show="!raw" ng-click="raw=true" >Show Raw</button>
        <button class="btn btn-primary" ng-show="raw" ng-click="raw=false" >Show Object</button>
        <json-formatter ng-show="!raw" json=submitSubstance open="666"></json-formatter>
	<pre ng-show="raw">{{substance | json}}</pre>
    </div>
    <div class ="row info">
        <button ng-click="submitpaster(paste); validate(substance)">paste</button>
</div>

      <script>
        var loadjson = @Html(json);
        </script>

        <script type="text/ng-template" id="tag-template-script">
        <div class="tag-template" >
        <div tooltip="{{data.citation}}">
        <span>{{$getDisplayText()}}</span>
        <a class="remove-button" ng-click="$removeTag()">&#10006;</a>
        </div>
        </div>
        </script>

    @fileimport() @addnamelist()
}

