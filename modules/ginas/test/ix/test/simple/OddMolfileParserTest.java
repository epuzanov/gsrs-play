package ix.test.simple;

import static org.junit.Assert.*;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.junit.Test;


import chemaxon.formats.MolImporter;
import chemaxon.struc.MolAtom;
import chemaxon.struc.MolBond;
import chemaxon.struc.Molecule;
import chemaxon.util.MolHandler;
import ix.core.chem.StructureProcessor;
import ix.core.models.Structure;

/**
 * Simple tests to make sure that molfiles
 * of strange character are still imported
 * correctly
 * 
 * @author tyler
 *
 */
public final class OddMolfileParserTest {
	String ODD_MOLFILE_BRACKETS="\n" + 
			"  Symyx   03161717412D 1   1.00000     0.00000     0\n" + 
			"\n" + 
			" 94105  0     1  0            999 V2000\n" + 
			"   17.0912   -8.1355    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   19.7204   -7.0647    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   18.1496  -10.7814    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   19.1329  -14.3189    0.0000 N   0  0  3  0  0  0           0  0  0\n" + 
			"   18.4746  -14.9856    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   17.9621   -7.9688    0.0000 N   0  0  0  0  0  4           0  0  0\n" + 
			"   18.0162   -9.9272    0.0000 N   0  5  0  0  0  3           0  0  0\n" + 
			"   18.1496   -7.0772    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   19.7204  -10.8022    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   19.8871   -7.9813    0.0000 N   0  0  0  0  0  4           0  0  0\n" + 
			"   19.8746   -9.9105    0.0000 N   0  0  0  0  0  4           0  0  0\n" + 
			"   17.1079   -9.7730    0.0000 C   0  0  3  0  0  0           0  0  0\n" + 
			"   20.7704   -9.7064    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   18.9454   -6.6438    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.7080   -7.3522    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   18.9454  -11.2272    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   20.5454   -6.6314    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   17.3204  -11.2480    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   17.5620  -14.8355    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   20.7245   -8.1023    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.1412  -15.6771    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   18.6204  -15.9272    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   16.6996  -10.6314    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   14.5371  -16.1188    0.0000 P   0  0  3  0  0  0           0  0  0\n" + 
			"   20.0371  -14.5022    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.1745   -8.9189    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.3454   -6.6980    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   19.0161  -13.3814    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.1954  -10.5939    0.0000 C   0  0  3  0  0  0           0  0  0\n" + 
			"   20.5870  -11.2188    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   19.8538  -12.9856    0.0000 N   0  0  0  0  0  4           0  0  0\n" + 
			"   21.1704   -7.2480    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   17.7870  -16.3480    0.0000 C   0  0  2  0  0  0           0  0  0\n" + 
			"   20.4912  -13.6772    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.3287  -16.1438    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   20.5162  -15.3022    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.8496  -12.0563    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   15.9078   -6.8772    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   20.5454   -5.6939    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.4163  -13.6523    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.4454  -15.2938    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.3370   -5.7564    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   20.5870  -12.1604    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   15.7746  -10.6314    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.8955  -14.4689    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   22.0828   -7.2563    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.9788   -6.8731    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.3412   -5.2230    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.5288  -17.0564    0.0000 O   0  5  0  0  0  0           0  0  0\n" + 
			"   14.9788  -10.1480    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.0871  -15.2897    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   15.4621  -12.8689    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   13.7246  -16.5814    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   22.2995  -12.6231    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   23.4662   -8.0647    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.5496  -12.8606    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   21.3412   -4.2855    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   14.9788   -9.2065    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   14.5120   -6.0647    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   15.9246  -13.6813    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   17.0995  -14.0147    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   22.7454  -11.8147    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   23.9287   -7.2438    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   15.9329  -12.0563    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.3788  -12.6231    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   22.5412   -8.0647    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.2913   -8.6064    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.5371  -14.4939    0.0000 C   0  0  1  0  0  0           0  0  0\n" + 
			"   18.9454   -5.7147    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   18.9454  -12.1813    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   15.9078   -7.8230    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.4663   -6.6314    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   14.1870  -10.6314    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   14.5120   -7.6980    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   22.1412   -5.6939    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   23.9287   -8.8856    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   22.7454  -13.4314    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   14.0829  -13.6689    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.7787  -12.0606    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.3204  -17.1605    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.9954  -10.1147    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   21.9954  -11.0563    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.7829  -17.9814    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   21.9038  -16.1188    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   22.8080  -14.4605    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   15.4621  -14.4939    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.5368   -5.2820    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   16.5287   -4.3398    0.0000 C   0  0  0  0  0  0           0  0  0\n" + 
			"   17.3317   -3.8574    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"   15.7176   -3.8673    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   18.8787   -8.9439    0.0000 Co  0  1  0  0  0  0           0  0  0\n" + 
			"   19.9454   -4.8439    0.0000 O   0  5  0  0  0  2           0  0  0\n" + 
			"   19.5963   -3.2620    0.0000 N   0  0  0  0  0  0           0  0  0\n" + 
			"   18.4826   -2.6389    0.0000 O   0  0  0  0  0  0           0  0  0\n" + 
			"  5  4  1  1     0  0\n" + 
			"  6  1  1  0     0  0\n" + 
			"  3  7  1  0     0  0\n" + 
			"  8  6  2  0     0  0\n" + 
			" 10  2  1  0     0  0\n" + 
			" 11  9  2  0     0  0\n" + 
			"  7 12  1  0     0  0\n" + 
			" 12  1  1  0     0  0\n" + 
			" 13 11  1  0     0  0\n" + 
			" 14  8  1  0     0  0\n" + 
			"  2 14  2  0     0  0\n" + 
			" 15  1  1  0     0  0\n" + 
			"  9 16  1  0     0  0\n" + 
			" 16  3  2  0     0  0\n" + 
			" 17  2  1  0     0  0\n" + 
			"  3 18  1  0     0  0\n" + 
			"  5 19  1  0     0  0\n" + 
			" 20 10  2  0     0  0\n" + 
			" 19 21  1  0     0  0\n" + 
			"  5 22  1  0     0  0\n" + 
			" 18 23  1  0     0  0\n" + 
			" 23 12  1  0     0  0\n" + 
			" 25  4  1  0     0  0\n" + 
			" 26 20  1  0     0  0\n" + 
			" 26 13  2  0     0  0\n" + 
			" 27 15  1  0     0  0\n" + 
			"  8 27  1  0     0  0\n" + 
			" 28  4  1  0     0  0\n" + 
			" 13 29  1  0     0  0\n" + 
			" 29 30  1  0     0  0\n" + 
			" 30  9  1  0     0  0\n" + 
			" 31 28  2  0     0  0\n" + 
			" 32 17  1  0     0  0\n" + 
			" 20 32  1  0     0  0\n" + 
			" 22 33  1  0     0  0\n" + 
			" 33 21  1  0     0  0\n" + 
			" 34 25  2  0     0  0\n" + 
			" 31 34  1  0     0  0\n" + 
			" 21 35  1  1     0  0\n" + 
			" 35 24  1  0     0  0\n" + 
			" 36 25  1  0     0  0\n" + 
			" 18 37  1  6     0  0\n" + 
			" 15 38  1  1     0  0\n" + 
			" 17 39  1  1     0  0\n" + 
			" 40 34  1  0     0  0\n" + 
			" 41 36  2  0     0  0\n" + 
			" 27 42  1  6     0  0\n" + 
			" 30 43  1  6     0  0\n" + 
			" 23 44  1  1     0  0\n" + 
			" 45 41  1  0     0  0\n" + 
			" 40 45  2  0     0  0\n" + 
			" 32 46  1  6     0  0\n" + 
			" 47 38  1  0     0  0\n" + 
			" 48 39  1  0     0  0\n" + 
			" 49 24  1  0     0  0\n" + 
			" 50 44  1  0     0  0\n" + 
			" 24 51  1  0     0  0\n" + 
			" 53 24  2  0     0  0\n" + 
			" 56 52  1  0     0  0\n" + 
			" 57 48  2  0     0  0\n" + 
			" 58 50  2  0     0  0\n" + 
			" 59 47  2  0     0  0\n" + 
			" 60 52  2  0     0  0\n" + 
			" 19 61  1  1     0  0\n" + 
			" 62 54  2  0     0  0\n" + 
			" 63 55  2  0     0  0\n" + 
			" 52 64  1  0     0  0\n" + 
			" 64 37  1  0     0  0\n" + 
			" 54 65  1  0     0  0\n" + 
			" 65 43  1  0     0  0\n" + 
			" 55 66  1  0     0  0\n" + 
			" 66 46  1  0     0  0\n" + 
			"  1 67  1  6     0  0\n" + 
			" 51 68  1  0     0  0\n" + 
			" 69 14  1  0     0  0\n" + 
			" 70 16  1  0     0  0\n" + 
			" 15 71  1  6     0  0\n" + 
			" 17 72  1  6     0  0\n" + 
			" 73 50  1  0     0  0\n" + 
			" 74 47  1  0     0  0\n" + 
			" 75 48  1  0     0  0\n" + 
			" 76 55  1  0     0  0\n" + 
			" 77 54  1  0     0  0\n" + 
			" 68 78  1  0     0  0\n" + 
			" 78 56  1  0     0  0\n" + 
			" 18 79  1  1     0  0\n" + 
			" 33 80  1  6     0  0\n" + 
			" 81 29  1  0     0  0\n" + 
			" 82 29  1  0     0  0\n" + 
			" 83 80  1  0     0  0\n" + 
			" 84 41  1  0     0  0\n" + 
			" 85 45  1  0     0  0\n" + 
			" 68 86  1  1     0  0\n" + 
			" 42 87  1  0     0  0\n" + 
			" 87 88  1  0     0  0\n" + 
			" 88 89  2  0     0  0\n" + 
			" 88 90  1  0     0  0\n" + 
			"  7 91  1  0     0  0\n" + 
			" 11 91  1  0     0  0\n" + 
			" 91 10  1  0     0  0\n" + 
			" 91  6  1  0     0  0\n" + 
			" 31 91  1  0     0  0\n" + 
			" 91 92  1  0     0  0\n" + 
			" 93 92  1  0     0  0\n" + 
			" 93 94  2  0     0  0\n" + 
			"M  CHG  4   7  -1  49  -1  91   3  92  -1\n" + 
			"M  STY  2   1 GEN   2 DAT\n" + 
			"M  SLB  2   1   1   2   2\n" + 
			"M  SAL   1 15   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15\n" + 
			"M  SAL   1 15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30\n" + 
			"M  SAL   1 15  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45\n" + 
			"M  SAL   1 15  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60\n" + 
			"M  SAL   1 15  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75\n" + 
			"M  SAL   1 15  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n" + 
			"M  SAL   1  4  91  92  93  94\n" + 
			"M  SDI   1  4   13.2787  -18.3855   13.2787   -3.4055\n" + 
			"M  SDI   1  4   24.6287   -3.4055   24.6287  -18.3855\n" + 
			"M  SDT   2 FDAREG_SGROUP                 F\n" + 
			"M  SDD   2    24.9287   -3.8555    DA    ALL  1       5\n" + 
			"M  SED   2 OC-6\n" + 
			"M  SPL  1   2   1\n" + 
			"M  END";
	
	@Test
	public void readOddMolfile() throws Exception{
		try {
			MolHandler mh = new MolHandler(ODD_MOLFILE_BRACKETS);
			Molecule m = mh.getMolecule();
			assertNotNull(m);
		} catch (Throwable e) {
			e.printStackTrace();
			throw e;
		}
	}

	
	@Test
	public void instrumentOddMolfile() throws Exception{
		try {
			List<Structure> slist = new ArrayList<>();
			StructureProcessor.instrument(ODD_MOLFILE_BRACKETS, slist, true);
		} catch (Throwable e) {
			e.printStackTrace();
			throw e;
		}
	}

}
